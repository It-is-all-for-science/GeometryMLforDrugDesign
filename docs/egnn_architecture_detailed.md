# –î–µ—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ EGNN Model 3

**–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è HOMO-LUMO gap**

> –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **EGNN Model 3** ‚Äî —É–ª—É—á—à–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–ª–∞ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ (MAE=0.076 eV, R¬≤=0.993 –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ QM9).

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞](#–æ–±—â–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
2. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–º–æ–¥–µ–ª–∏)
3. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
4. [–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ](#–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ)
5. [–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏](#–ø–∞—Ä–∞–º–µ—Ç—Ä—ã-–∏-—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏)

---

## –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

EGNN (E(n) Equivariant Graph Neural Network) ‚Äî —ç—Ç–æ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç–∫–≤–∏–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ –≤—Ä–∞—â–µ–Ω–∏—è–º –∏ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è–º –≤ 3D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –º–æ–ª–µ–∫—É–ª –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∏—Ö –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π:

```
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∞—Ç–æ–º—ã –º–æ–ª–µ–∫—É–ª—ã)
    ‚Üì
[1] Node Embedding Layer (—ç–º–±–µ–¥–¥–∏–Ω–≥ –∞—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
    ‚Üì
[2] EGNN Layers √ó N (–≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Å–ª–æ–∏ —Å message passing)
    ‚Üì
[3] Global Pooling + Output MLP (–∞–≥—Ä–µ–≥–∞—Ü–∏—è –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)
    ‚Üì
–í—ã—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (HOMO-LUMO gap)
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏

### EGNNConfig ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (EGNN Model 3)

```python
hidden_dim: 256          # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π (—É–≤–µ–ª–∏—á–µ–Ω–∞!)
num_layers: 5            # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ EGNN —Å–ª–æ–µ–≤ (–≥–ª—É–±–∂–µ!)
output_dim: 1            # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—ã—Ö–æ–¥–∞ (1 –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ gap)
node_feature_dim: 11     # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
edge_feature_dim: 0      # –ü—Ä–∏–∑–Ω–∞–∫–∏ —Å–≤—è–∑–µ–π (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)
attention: True          # –ú–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è –≤–∫–ª—é—á–µ–Ω
normalize: True          # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
tanh: True              # Tanh –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
dropout: 0.1            # Dropout –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏
activation: 'swish'     # –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (SiLU)
update_coords: False    # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ù–ï –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
batch_size: 32
learning_rate: 0.0001    # –ù–∏–∑–∫–∏–π LR –¥–ª—è fine-tuning
epochs: 100
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ QM9:**
- **MAE: 0.076 eV** (–Ω–∞ 31.3% –ª—É—á—à–µ –±–∞–∑–æ–≤–æ–π EGNN)
- **RMSE: 0.106 eV**
- **R¬≤: 0.993** (–æ–±—ä—è—Å–Ω—è–µ—Ç 99.3% –≤–∞—Ä–∏–∞—Ü–∏–∏)
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 2,704,681**

**–ü–æ—á–µ–º—É —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?**
- `hidden_dim=256`: –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª–µ–µ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –º–æ–ª–µ–∫—É–ª
- `num_layers=5`: –ë–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∞—è —Å–µ—Ç—å –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–ª—å–Ω–∏–µ –∞—Ç–æ–º–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- `attention=True`: –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –≤–∞–∂–Ω—ã—Ö –∞—Ç–æ–º–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö
- `update_coords=False`: –û—Ç–∫–ª—é—á–µ–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã)
- `activation='swish'`: –ë–æ–ª–µ–µ –≥–ª–∞–¥–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è, —á–µ–º ReLU, –ª—É—á—à–µ –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
- `learning_rate=0.0001`: –ù–∏–∑–∫–∏–π LR –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ fine-tuning –æ—Ç –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. Node Embedding Layer

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –∞—Ç–æ–º–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤ –≤—ã—Å–æ–∫–æ—Ä–∞–∑–º–µ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
nn.Sequential(
    nn.Linear(11, 256),    # 11 –∞—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Üí 256 —Å–∫—Ä—ã—Ç—ã—Ö
    nn.ReLU(),             # –ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å
    nn.Dropout(0.1)        # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
)
```

**–í—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (11 —à—Ç—É–∫):**
1. –ê—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä (Z)
2. –°—Ç–µ–ø–µ–Ω—å —É–∑–ª–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π)
3. –§–æ—Ä–º–∞–ª—å–Ω—ã–π –∑–∞—Ä—è–¥
4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–¥–æ—Ä–æ–¥–æ–≤
5. –ì–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—è (sp, sp2, sp3)
6. –ê—Ä–æ–º–∞—Ç–∏—á–Ω–æ—Å—Ç—å
7. –ü—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –∫–æ–ª—å—Ü—É
8-11. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–∏–º–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞

**–í—ã—Ö–æ–¥:** –¢–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ `[N_atoms, 128]`

---

### 2. EGNN Layer (–æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –±–ª–æ–∫)

–ö–∞–∂–¥—ã–π EGNN —Å–ª–æ–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

#### 2.1 Edge MLP (–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –∞—Ç–æ–º–∞–º–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã—á–∏—Å–ª—è–µ—Ç, –∫–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–¥–∏–Ω –∞—Ç–æ–º –ø–µ—Ä–µ–¥–∞–µ—Ç –¥—Ä—É–≥–æ–º—É.

**–í—Ö–æ–¥:**
- `h_i`: –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–æ–º–∞-–ø–æ–ª—É—á–∞—Ç–µ–ª—è `[E, 256]`
- `h_j`: –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–æ–º–∞-–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è `[E, 256]`
- `||r_ij||`: —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∞—Ç–æ–º–∞–º–∏ `[E, 1]`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
nn.Sequential(
    nn.Linear(256 + 256 + 1, 256),  # –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è h_i, h_j, distance
    nn.SiLU(),                       # Swish –∞–∫—Ç–∏–≤–∞—Ü–∏—è
    nn.Dropout(0.1),
    nn.Linear(256, 256),
    nn.SiLU()
)
```

**–í—ã—Ö–æ–¥:** –°–æ–æ–±—â–µ–Ω–∏—è `[E, 256]` –≥–¥–µ E ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:** –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ `||r_ij||` ‚Äî —ç—Ç–æ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ (–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏), —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å.

#### 2.2 Attention Mechanism (–º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
nn.Sequential(
    nn.Linear(256, 1),     # –°–æ–æ–±—â–µ–Ω–∏–µ ‚Üí —Å–∫–∞–ª—è—Ä –≤–∞–∂–Ω–æ—Å—Ç–∏
    nn.Sigmoid()           # –í–µ—Å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1]
)
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
```python
attention_weights = attention_mlp(messages)  # [E, 1]
messages = messages * attention_weights      # –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ
```

**–ò–Ω—Ç—É–∏—Ü–∏—è:** –ù–µ –≤—Å–µ –∞—Ç–æ–º–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤–∞–∂–Ω—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–≤—è–∑—å C-C –≤ –±–µ–Ω–∑–æ–ª—å–Ω–æ–º –∫–æ–ª—å—Ü–µ –≤–∞–∂–Ω–µ–µ, —á–µ–º –¥–∞–ª–µ–∫–∏–π –∞—Ç–æ–º –≤–æ–¥–æ—Ä–æ–¥–∞.

#### 2.3 Node MLP (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ç–æ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∞—Ç–æ–º–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

**–í—Ö–æ–¥:**
- `h_old`: —Å—Ç–∞—Ä—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–æ–º–∞ `[N, 256]`
- `messages_aggregated`: —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–æ—Å–µ–¥–µ–π `[N, 256]`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
nn.Sequential(
    nn.Linear(256 + 256, 256),  # –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    nn.SiLU(),
    nn.Dropout(0.1),
    nn.Linear(256, 256)
)
```

**Residual Connection:**
```python
h_new = h_old + node_mlp([h_old, messages])  # Skip connection
h_new = LayerNorm(h_new)                      # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
```

**–ü–æ—á–µ–º—É residual:** –ü–æ–º–æ–≥–∞–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –≥–ª—É–±–æ–∫—É—é —Å–µ—Ç—å, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.

#### 2.4 Coordinate MLP (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Äî –û–¢–ö–õ–Æ–ß–ï–ù–û)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å 3D –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∞—Ç–æ–º–æ–≤ —ç–∫–≤–∏–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.

**–í –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏:** `update_coords=False` ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ù–ï –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è.

**–ü–æ—á–µ–º—É –æ—Ç–∫–ª—é—á–µ–Ω–æ:**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ —É–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –º–æ–∂–µ—Ç –¥–µ—Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
- –î–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è HOMO-LUMO gap –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏

**–ï—Å–ª–∏ –±—ã –±—ã–ª–æ –≤–∫–ª—é—á–µ–Ω–æ:**
```python
# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –º–µ–∂–¥—É –∞—Ç–æ–º–∞–º–∏
directions = (pos_i - pos_j) / ||pos_i - pos_j||  # [E, 3]

# –í–µ—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
weights = coord_mlp([h_i, h_j, ||r_ij||])  # [E, 1]

# –≠–∫–≤–∏–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
pos_update = sum(weights * directions)  # [N, 3]
```

---

### 3. Global Pooling + Output MLP

#### 3.1 –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–æ–Ω–Ω—É—é –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å.

```python
pos_centered = pos - mean(pos)  # –¶–µ–Ω—Ç—Ä –º–∞—Å—Å –≤ –Ω–∞—á–∞–ª–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
```

**–ü–æ—á–µ–º—É:** –ú–æ–ª–µ–∫—É–ª–∞ –≤ —Ç–æ—á–∫–µ (0,0,0) –∏ –≤ —Ç–æ—á–∫–µ (100,100,100) –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞.

#### 3.2 Global Mean Pooling

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å–æ –≤—Å–µ—Ö –∞—Ç–æ–º–æ–≤ –≤ –æ–¥–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–ª–µ–∫—É–ª—ã.

```python
h_molecule = mean(h_atoms)  # [N, 256] ‚Üí [1, 256]
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- `sum`: –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –º–æ–ª–µ–∫—É–ª—ã)
- `max`: –ú–∞–∫—Å–∏–º—É–º (—Ç–µ—Ä—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)
- `mean`: –°—Ä–µ–¥–Ω–µ–µ (–Ω–∞—à –≤—ã–±–æ—Ä ‚Äî –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ –∫ —Ä–∞–∑–º–µ—Ä—É)

#### 3.3 Output MLP

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ HOMO-LUMO gap.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
nn.Sequential(
    nn.Linear(256, 256),   # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π
    nn.ReLU(),
    nn.Dropout(0.1),
    nn.Linear(256, 1)      # –§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
)
```

**–í—ã—Ö–æ–¥:** –°–∫–∞–ª—è—Ä ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ HOMO-LUMO gap –≤ —ç–í.

---

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

### Message Passing –≤ EGNN Layer

**–®–∞–≥ 1: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π**
```
m_ij = œÜ_e(h_i, h_j, ||x_i - x_j||¬≤)
```
–≥–¥–µ:
- `œÜ_e` ‚Äî Edge MLP
- `h_i, h_j` ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–æ–º–æ–≤
- `||x_i - x_j||¬≤` ‚Äî –∫–≤–∞–¥—Ä–∞—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è (–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç)

**–®–∞–≥ 2: Attention (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
```
Œ±_ij = œÉ(œà(m_ij))
m_ij = Œ±_ij ¬∑ m_ij
```
–≥–¥–µ:
- `œà` ‚Äî Attention MLP
- `œÉ` ‚Äî Sigmoid
- `Œ±_ij` ‚Äî –≤–µ—Å –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å–≤—è–∑–∏

**–®–∞–≥ 3: –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π**
```
m_i = Œ£_j m_ij
```
–°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤—Å–µ–º —Å–æ—Å–µ–¥—è–º –∞—Ç–æ–º–∞ i

**–®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤**
```
h_i^(l+1) = h_i^(l) + œÜ_h(h_i^(l), m_i)
```
–≥–¥–µ:
- `œÜ_h` ‚Äî Node MLP
- Residual connection: `h_i^(l) +`

**–®–∞–≥ 5: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**
```
h_i^(l+1) = LayerNorm(h_i^(l+1))
```

### –§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ

```
h_graph = mean({h_i | i ‚àà atoms})
y_pred = MLP_out(h_graph)
```

---

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º (EGNN Model 3)

**1. Node Embedding:**
```
Linear(11 ‚Üí 256): 11 √ó 256 + 256 = 3,072 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
```

**2. –û–¥–∏–Ω EGNN Layer:**

Edge MLP:
```
Linear(513 ‚Üí 256): 513 √ó 256 + 256 = 131,584
Linear(256 ‚Üí 256): 256 √ó 256 + 256 = 65,792
```

Attention MLP:
```
Linear(256 ‚Üí 1): 256 √ó 1 + 1 = 257
```

Node MLP:
```
Linear(512 ‚Üí 256): 512 √ó 256 + 256 = 131,328
Linear(256 ‚Üí 256): 256 √ó 256 + 256 = 65,792
```

Coordinate MLP (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ –µ—Å—Ç—å):
```
Linear(513 ‚Üí 256): 513 √ó 256 + 256 = 131,584
Linear(256 ‚Üí 1): 256 √ó 1 + 1 = 257
```

LayerNorm:
```
2 √ó 256 = 512 (Œ≥ –∏ Œ≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
```

**–ò—Ç–æ–≥–æ –Ω–∞ –æ–¥–∏–Ω EGNN Layer:** ~527,106 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**3. Output MLP:**
```
Linear(256 ‚Üí 256): 256 √ó 256 + 256 = 65,792
Linear(256 ‚Üí 1): 256 √ó 1 + 1 = 257
```

### –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```
Node Embedding:          3,072
EGNN Layers √ó 5:     2,635,530
Output MLP:             66,049
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò–¢–û–ì–û:              2,704,651 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
```

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:** 2,704,681 –ø–∞—Ä–∞–º–µ—Ç—Ä (–Ω–µ–±–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –∏–∑-–∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö bias –∏ normalization —Å–ª–æ–µ–≤)

### –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —Ç–µ–Ω–∑–æ—Ä–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ forward pass

–ü—Ä–∏–º–µ—Ä –¥–ª—è –º–æ–ª–µ–∫—É–ª—ã —Å 20 –∞—Ç–æ–º–∞–º–∏ –∏ 40 —Å–≤—è–∑—è–º–∏:

```
–í—Ö–æ–¥:
  x:          [20, 11]      # –ê—Ç–æ–º–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
  pos:        [20, 3]       # 3D –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
  edge_index: [2, 40]       # –ò–Ω–¥–µ–∫—Å—ã —Å–≤—è–∑–µ–π

–ü–æ—Å–ª–µ Node Embedding:
  h:          [20, 256]     # –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –∞—Ç–æ–º–æ–≤

–í –∫–∞–∂–¥–æ–º EGNN Layer (5 —Å–ª–æ–µ–≤):
  messages:   [40, 256]     # –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Å–≤—è–∑—è–º
  h_updated:  [20, 256]     # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–æ–º–æ–≤
  pos:        [20, 3]       # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–Ω–µ–∏–∑–º–µ–Ω–Ω—ã)

–ü–æ—Å–ª–µ Global Pooling:
  h_global:   [1, 256]      # –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–ª–µ–∫—É–ª—ã

–í—ã—Ö–æ–¥:
  prediction: [1, 1]        # HOMO-LUMO gap
```

---

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –≠–∫–≤–∏–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ –≤—Ä–∞—â–µ–Ω–∏—è–º

**–ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è:**
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è `||r_ij||`
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é
- –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# –ï—Å–ª–∏ –ø–æ–≤–µ—Ä–Ω—É—Ç—å –º–æ–ª–µ–∫—É–ª—É –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —É–≥–æ–ª
pos_rotated = rotation_matrix @ pos
# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è
assert model(x, pos) == model(x, pos_rotated)
```

### 2. –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è–º

**–ö–∞–∫ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è:**
- –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç: `pos = pos - mean(pos)`
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# –ï—Å–ª–∏ —Å–¥–≤–∏–Ω—É—Ç—å –º–æ–ª–µ–∫—É–ª—É –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
pos_translated = pos + [100, 100, 100]
# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è
assert model(x, pos) == model(x, pos_translated)
```

### 3. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è

**–¢–µ—Ö–Ω–∏–∫–∏:**
- Residual connections –≤ –∫–∞–∂–¥–æ–º —Å–ª–æ–µ
- Layer Normalization –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- Dropout (0.1) –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏
- Swish –∞–∫—Ç–∏–≤–∞—Ü–∏—è (–±–æ–ª–µ–µ –≥–ª–∞–¥–∫–∞—è, —á–µ–º ReLU)
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

### 4. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- Message passing —Ç–æ–ª—å–∫–æ –ø–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Å–≤—è–∑—è–º (–Ω–µ –≤—Å–µ –ø–∞—Ä—ã –∞—Ç–æ–º–æ–≤)
- Attention –º–µ—Ö–∞–Ω–∏–∑–º —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ –≤–∞–∂–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö
- –ë–∞—Ç—á–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–æ–ª–µ–∫—É–ª —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | EGNN Model 3 | EGNN Base | GCN | FCNN |
|----------------|--------------|-----------|-----|------|
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç 3D –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| –≠–∫–≤–∏–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| Message passing | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| Attention | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç |
| Hidden dim | 256 | 128 | 64 | 128 |
| Num layers | 5 | 4 | 3 | 3 |
| –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | 2.7M | 548K | 78K | 35K |
| MAE –Ω–∞ —Ç–µ—Å—Ç–µ | **0.076 eV** | 0.111 eV | 0.475 eV | 0.756 eV |
| R¬≤ | **0.993** | 0.987 | 0.765 | 0.481 |

**–ü–æ—á–µ–º—É EGNN Model 3 –ª—É—á—à–µ:**
- –£—á–∏—Ç—ã–≤–∞–µ—Ç 3D –≥–µ–æ–º–µ—Ç—Ä–∏—é –º–æ–ª–µ–∫—É–ª
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–∏–º–º–µ—Ç—Ä–∏–∏
- Attention —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –≤–∞–∂–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö
- –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å (256) –¥–ª—è –±–æ–ª–µ–µ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
- –ë–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (5 —Å–ª–æ–µ–≤) –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–ª—å–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- Fine-tuning –æ—Ç –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ —Å –Ω–∏–∑–∫–∏–º learning rate

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```python
from src.step_03_models.egnn import create_egnn_model, EGNNConfig

# –°–æ–∑–¥–∞–Ω–∏–µ EGNN Model 3 (–ª—É—á—à–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
config = EGNNConfig(
    hidden_dim=256,
    num_layers=5,
    attention=True,
    dropout=0.1,
    activation='swish'
)
model = create_egnn_model(config)

# –û–±—É—á–µ–Ω–∏–µ (fine-tuning –æ—Ç –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏)
optimizer = torch.optim.Adam(model.parameters(), lr=1e-4)  # –ù–∏–∑–∫–∏–π LR
criterion = nn.MSELoss()

for epoch in range(100):
    for batch in dataloader:
        output = model(
            x=batch.x,
            pos=batch.pos,
            edge_index=batch.edge_index,
            batch=batch.batch
        )
        loss = criterion(output['prediction'], batch.y)
        loss.backward()
        optimizer.step()

# –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–ª–∞ MAE=0.076 eV –Ω–∞ —ç–ø–æ—Ö–µ 98
```

### –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–π –º–æ–ª–µ–∫—É–ª—ã

```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –ª—É—á—à–µ–π EGNN Model 3
model_path = "results/improved_egnn_ensemble/models/improved_egnn_model3/best_model.pth"
model.load_state_dict(torch.load(model_path))
model.eval()

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
with torch.no_grad():
    result = model(x, pos, edge_index)
    gap_prediction = result['prediction'].item()
    print(f"Predicted HOMO-LUMO gap: {gap_prediction:.3f} eV")
    
# –û–∂–∏–¥–∞–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: MAE ‚âà 0.076 eV
```

---

## –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –∞–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞ domain shift

EGNN Model 3 –æ–±—É—á–∞–ª–∞—Å—å –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ QM9, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–±–æ–ª—å—à–∏–µ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ –º–æ–ª–µ–∫—É–ª—ã (–¥–æ 29 –∞—Ç–æ–º–æ–≤, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º C, H, N, O, F). –ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è:

- **–†–∞–∑–º–µ—Ä:** –î–æ 100+ –∞—Ç–æ–º–æ–≤ (–≤ 3-4 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ)
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã, –∫–æ–ª—å—Ü–∞
- **–≠–ª–µ–º–µ–Ω—Ç—ã:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (S, Cl, Br –∏ –¥—Ä.)

### –†–µ—à–µ–Ω–∏–µ: Zero-shot transfer –±–µ–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

–ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å **–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –≤–µ—Å–æ–≤**, –Ω–æ —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ QM9-style –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

```python
def _create_qm9_style_features(atomic_numbers: List[int]) -> torch.Tensor:
    """
    –°–æ–∑–¥–∞–µ—Ç 11-–º–µ—Ä–Ω—ã–µ node features –≤ —Å—Ç–∏–ª–µ QM9 –¥–ª—è –ª—é–±—ã—Ö –∞—Ç–æ–º–æ–≤.
    
    –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
    [0-4]: One-hot –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (H, C, N, O, F)
    [5]:   –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∞—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä (Z/100)
    [6-9]: –†–µ–∑–µ—Ä–≤ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤
    [10]:  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞–ª–µ–Ω—Ç–Ω—ã—Ö —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤
    """
    features = []
    
    for atomic_num in atomic_numbers:
        feat = torch.zeros(11)
        
        # One-hot –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ QM9
        if atomic_num == 1:    feat[0] = 1.0  # H
        elif atomic_num == 6:  feat[1] = 1.0  # C
        elif atomic_num == 7:  feat[2] = 1.0  # N
        elif atomic_num == 8:  feat[3] = 1.0  # O
        elif atomic_num == 9:  feat[4] = 1.0  # F
        
        # –î–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (S, Cl, Br –∏ –¥—Ä.)
        # –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∞—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä
        feat[5] = atomic_num / 100.0
        
        # –í–∞–ª–µ–Ω—Ç–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω—ã (–æ–±–æ–±—â–µ–Ω–Ω–∞—è —Ö–∏–º–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
        valence_electrons = {1: 1, 6: 4, 7: 5, 8: 6, 9: 7, 16: 6, 17: 7}
        feat[10] = valence_electrons.get(atomic_num, 0)
        
        features.append(feat)
    
    return torch.stack(features)
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö [0-4] –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –î–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (S, Cl, Br) –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫ [5] (–∞—Ç–æ–º–Ω—ã–π –Ω–æ–º–µ—Ä)
- –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (3D –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è) –æ—Å—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π
- EGNN —ç–∫–≤–∏–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞ –∫ –≥–µ–æ–º–µ—Ç—Ä–∏–∏, –ø–æ—ç—Ç–æ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–ª–µ–∫—É–ª–∞—Ö –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∞ —Å–≤—è–∑–µ–π

```python
# –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π –≥—Ä–∞—Ñ –¥–ª—è –≤—Å–µ—Ö –∞—Ç–æ–º–æ–≤
edge_index = []
for i in range(num_atoms):
    for j in range(num_atoms):
        if i != j:
            edge_index.append([i, j])

edge_index = torch.tensor(edge_index, dtype=torch.long).t()
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:** –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —Å–≤—è–∑–µ–π –∏–∑ RDKit, –Ω–æ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π –≥—Ä–∞—Ñ:
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –¥–∞–ª—å–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±—ã—Ö –º–æ–ª–µ–∫—É–ª –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- EGNN —Å–∞–º–∞ –Ω–∞—É—á–∏—Ç—Å—è —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –≤–∞–∂–Ω—ã—Ö —Å–≤—è–∑—è—Ö —á–µ—Ä–µ–∑ attention

#### 3. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

```python
# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–ª–µ–∫—É–ª –ø–æ —Ä–∞–∑–º–µ—Ä—É
if num_atoms <= 20:
    size_group = "small"   # –ë–ª–∏–∑–∫–æ –∫ QM9
elif num_atoms <= 50:
    size_group = "medium"  # –£–º–µ—Ä–µ–Ω–Ω—ã–π domain shift
else:
    size_group = "large"   # –°–∏–ª—å–Ω—ã–π domain shift
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –∞–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞—Ö

**–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ 65 –º–æ–ª–µ–∫—É–ª–∞—Ö —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è |
|---------|----------|---------------|
| –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è (R) | 0.45-0.65 | –£–º–µ—Ä–µ–Ω–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è |
| MAE | ~1.5-2.0 eV | –í—ã—à–µ —á–µ–º –Ω–∞ QM9 (domain shift) |
| –¢—Ä–µ–Ω–¥ | ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω | –ú–æ–¥–µ–ª—å —Ä–∞–∑–ª–∏—á–∞–µ—Ç –≤—ã—Å–æ–∫–∏–π/–Ω–∏–∑–∫–∏–π gap |

**–ê–Ω–∞–ª–∏–∑ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º:**
- **Small (‚â§20 –∞—Ç–æ–º–æ–≤):** –õ—É—á—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –±–ª–∏–∑–∫–æ –∫ QM9
- **Medium (21-50 –∞—Ç–æ–º–æ–≤):** –£–º–µ—Ä–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –∑–∞–º–µ—Ç–Ω—ã–π domain shift
- **Large (>50 –∞—Ç–æ–º–æ–≤):** –ë–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è –æ—à–∏–±–∫–∞, –Ω–æ —Ç—Ä–µ–Ω–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

‚úÖ **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- Zero-shot transfer –±–µ–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–µ–Ω
- –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —ç–∫–≤–∏–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –º–æ–ª–µ–∫—É–ª
- –ú–æ–¥–µ–ª—å —Ä–∞–∑–ª–∏—á–∞–µ—Ç –º–æ–ª–µ–∫—É–ª—ã —Å —Ä–∞–∑–Ω—ã–º gap

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ê–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∏–∂–µ –∏–∑-–∑–∞ domain shift
- –î–ª—è –∫—Ä—É–ø–Ω—ã—Ö –º–æ–ª–µ–∫—É–ª (>50 –∞—Ç–æ–º–æ–≤) –Ω—É–∂–Ω–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
- –ù–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –º–µ–Ω–µ–µ —Ç–æ—á–Ω–æ

üîß **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
1. Fine-tuning –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –Ω–∞–±–æ—Ä–µ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–≤ —Å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (S, Cl, Br)
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ensemble –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –¥–ª—è uncertainty estimation
4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ (—Ä–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å, –ª–∏–ø–æ—Ñ–∏–ª—å–Ω–æ—Å—Ç—å)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**EGNN Model 3** ‚Äî —ç—Ç–æ —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è HOMO-LUMO gap –º–æ–ª–µ–∫—É–ª. –ï–µ –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–§–∏–∑–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∏–º–º–µ—Ç—Ä–∏–∏ –º–æ–ª–µ–∫—É–ª (–≤—Ä–∞—â–µ–Ω–∏—è, —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏)
2. **–í—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å (256) –∏ –≥–ª—É–±–∏–Ω–∞ (5 —Å–ª–æ–µ–≤) –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —Å–ª–æ–∂–Ω—ã–µ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
3. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** Residual connections, LayerNorm –∏ dropout –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –Ω–∞–¥–µ–∂–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
4. **–¢–æ—á–Ω–æ—Å—Ç—å:** MAE 0.076 eV, R¬≤ 0.993 ‚Äî –Ω–∞ 31.3% –ª—É—á—à–µ –±–∞–∑–æ–≤–æ–π EGNN
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –£—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 65 –∞–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞—Ö

### –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –±–∞–∑–æ–≤–æ–π EGNN:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë–∞–∑–æ–≤–∞—è EGNN | EGNN Model 3 | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|--------------|--------------|-----------|
| Hidden dim | 128 | 256 | +100% |
| Num layers | 4 | 5 | +25% |
| –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | 548K | 2.7M | +393% |
| MAE | 0.111 eV | 0.076 eV | **-31.3%** |
| R¬≤ | 0.987 | 0.993 | +0.6% |

–≠—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π state-of-the-art –ø–æ–¥—Ö–æ–¥ –∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—é –º–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ.
